
#!/usr/sbin/nft -f

flush ruleset

table inet my_filter {
    chain prerouting {
        type filter hook prerouting priority 0; policy accept;
        tcp dport 1-52 counter drop
        tcp dport 54-66 counter drop
        tcp dport 69-79 counter drop
        tcp dport 81-442 counter drop
        tcp dport 444-1193 counter drop
        tcp dport 1195-10000 counter drop
        tcp dport 10001-30000 counter drop

        udp dport 1-52 counter drop
        udp dport 54-66 counter drop
        udp dport 69-79 counter drop
        udp dport 81-442 counter drop
        udp dport 444-1193 counter drop
        udp dport 1195-10000 counter drop
        udp dport 10001-30000 counter drop
    }

    chain input {
        type filter hook input priority 0; policy accept;
        tcp dport 1-52 counter drop
        tcp dport 54-66 counter drop
        tcp dport 69-79 counter drop
        tcp dport 81-442 counter drop
        tcp dport 444-1193 counter drop
        tcp dport 1195-10000 counter drop
        tcp dport 10001-30000 counter drop

        udp dport 1-52 counter drop
        udp dport 54-66 counter drop
        udp dport 69-79 counter drop
        udp dport 81-442 counter drop
        udp dport 444-1193 counter drop
        udp dport 1195-10000 counter drop
        udp dport 10001-30000 counter drop
    }

    chain forward {
        type filter hook forward priority 0; policy accept;
        tcp dport 1-52 counter drop
        tcp dport 54-66 counter drop
        tcp dport 69-79 counter drop
        tcp dport 81-442 counter drop
        tcp dport 444-1193 counter drop
        tcp dport 1195-10000 counter drop
        tcp dport 10001-30000 counter drop

        udp dport 1-52 counter drop
        udp dport 54-66 counter drop
        udp dport 69-79 counter drop
        udp dport 81-442 counter drop
        udp dport 444-1193 counter drop
        udp dport 1195-10000 counter drop
        udp dport 10001-30000 counter drop
    }

    chain output {
        type filter hook output priority 0; policy accept;
    }

    chain postrouting {
        type filter hook postrouting priority 0; policy accept;
    }
}
